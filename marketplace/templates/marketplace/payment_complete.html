{% extends 'marketplace/base.html' %}

{% block title %}Checkout - Patch!{% endblock %}

{% block content %}
<section class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- È°µÈù¢Ê†áÈ¢ò -->
    <h1 class="text-3xl font-semibold mb-8 text-center" style="color: var(--primary-green);">Checkout</h1>

    <!-- ÂïÜÂìÅ‰ø°ÊÅØÂç°Áâá -->
    <div class="bg-white rounded-2xl shadow-sm p-6 mb-8 border" style="border-color: var(--light-gray);">
        <h2 class="text-sm font-semibold mb-4 uppercase tracking-wide" style="color: var(--dark-gray);">You are buying</h2>
        <div class="flex gap-4">
            <div class="w-20 h-20 rounded-lg overflow-hidden flex-shrink-0">
                {% if item.images.first %}
                    <img src="{{ item.images.first.image.url }}" alt="{{ item.name }}" class="w-full h-full object-cover">
                {% else %}
                    <div class="w-full h-full flex items-center justify-center" style="background-color: var(--light-gray);">
                        <span class="text-2xl">üé®</span>
                    </div>
                {% endif %}
            </div>
            <div class="flex-1">
                <h3 class="font-semibold mb-1" style="color: var(--text-black);">{{ item.name }}</h3>
                <div class="flex gap-2 mb-2">
                    {% if item.major %}
                    <span class="px-2 py-0.5 rounded-full text-xs tag">{{ item.get_major_display }}</span>
                    {% endif %}
                    {% if item.category %}
                    <span class="px-2 py-0.5 rounded-full text-xs tag">{{ item.get_category_display }}</span>
                    {% endif %}
                </div>
                <p class="text-xl font-semibold" style="color: var(--primary-orange);">${{ item.price }}</p>
            </div>
        </div>
    </div>

    <!-- ÊîØ‰ªòË°®Âçï -->
    <form method="post" id="paymentForm">
        {% csrf_token %}

        <!-- ‰∏™‰∫∫‰ø°ÊÅØ -->
        <div class="bg-white rounded-2xl shadow-sm p-6 mb-6 border" style="border-color: var(--light-gray);">
            <h2 class="text-lg font-semibold mb-4" style="color: var(--text-black);">Personal Details</h2>
            <div class="grid grid-cols-2 gap-4">
                <div class="col-span-2 sm:col-span-1">
                    <label class="block text-sm font-medium mb-2" style="color: var(--text-black);">Full Name</label>
                    <input type="text" name="full_name" required class="w-full px-4 py-3 border rounded-lg" style="border-color: var(--light-gray);" placeholder="John Doe">
                </div>
                <div class="col-span-2 sm:col-span-1">
                    <label class="block text-sm font-medium mb-2" style="color: var(--text-black);">Phone Number</label>
                    <input type="tel" name="phone" required class="w-full px-4 py-3 border rounded-lg" style="border-color: var(--light-gray);" placeholder="(123) 456-7890">
                </div>
                <div class="col-span-2">
                    <label class="block text-sm font-medium mb-2" style="color: var(--text-black);">Email</label>
                    <input type="email" name="email" required class="w-full px-4 py-3 border rounded-lg" style="border-color: var(--light-gray);" placeholder="john@example.com">
                </div>
            </div>
        </div>

        <!-- ÊîØ‰ªòÊñπÂºèÈÄâÊã© -->
        <div class="bg-white rounded-2xl shadow-sm p-6 mb-6 border" style="border-color: var(--light-gray);">
            <h2 class="text-lg font-semibold mb-4" style="color: var(--text-black);">Payment Method</h2>

            <div class="space-y-3">
                <!-- Venmo -->
                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer hover:border-current transition" style="border-color: var(--light-gray); color: var(--primary-orange);">
                    <input type="radio" name="payment_method" value="venmo" required class="mr-3">
                    <div class="flex-1 flex items-center justify-between">
                        <span class="font-medium" style="color: var(--text-black);">Venmo</span>
                        <span class="text-2xl">üì±</span>
                    </div>
                </label>

                <!-- Cash -->
                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer hover:border-current transition" style="border-color: var(--light-gray); color: var(--primary-orange);">
                    <input type="radio" name="payment_method" value="cash" required class="mr-3">
                    <div class="flex-1 flex items-center justify-between">
                        <span class="font-medium" style="color: var(--text-black);">Cash (In Person)</span>
                        <span class="text-2xl">üíµ</span>
                    </div>
                </label>

                <!-- Zelle -->
                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer hover:border-current transition" style="border-color: var(--light-gray); color: var(--primary-orange);">
                    <input type="radio" name="payment_method" value="zelle" required class="mr-3">
                    <div class="flex-1 flex items-center justify-between">
                        <span class="font-medium" style="color: var(--text-black);">Zelle</span>
                        <span class="text-2xl">üè¶</span>
                    </div>
                </label>
            </div>
        </div>

        <!-- ‰∫§‰ªòÊñπÂºè -->
        <div class="bg-white rounded-2xl shadow-sm p-6 mb-6 border" style="border-color: var(--light-gray);">
            <h2 class="text-lg font-semibold mb-4" style="color: var(--text-black);">Pickup Location</h2>

            <div class="space-y-3">
                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer hover:border-current transition" style="border-color: var(--light-gray); color: var(--primary-green);">
                    <input type="radio" name="pickup_location" value="campus_locker" required class="mr-3">
                    <div class="flex-1">
                        <div class="font-medium" style="color: var(--text-black);">Campus Locker üì¶</div>
                        <div class="text-sm mt-1" style="color: var(--dark-gray);">Safe and convenient on-campus pickup</div>
                    </div>
                </label>

                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer hover:border-current transition" style="border-color: var(--light-gray); color: var(--primary-green);">
                    <input type="radio" name="pickup_location" value="in_person" required class="mr-3">
                    <div class="flex-1">
                        <div class="font-medium" style="color: var(--text-black);">Meet in Person ü§ù</div>
                        <div class="text-sm mt-1" style="color: var(--dark-gray);">Arrange a meetup location</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- ÊåâÈíÆ -->
        <div class="flex gap-4">
            <a href="{% url 'marketplace:message_seller' item.id %}" class="flex-1 py-4 rounded-full font-medium text-center border hover:bg-gray-50 transition" style="border-color: var(--dark-gray); color: var(--dark-gray);">
                Back
            </a>
            <button type="submit" class="flex-1 py-4 rounded-full font-medium btn-primary">
                Confirm Payment
            </button>
        </div>
    </form>
</section>

<style>
    input[type="radio"]:checked + div {
        font-weight: 600;
    }

    label:has(input[type="radio"]:checked) {
        border-color: var(--primary-orange) !important;
        background-color: rgba(255, 121, 90, 0.05);
    }
</style>
{% endblock %}