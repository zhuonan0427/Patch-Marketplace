{% extends 'marketplace/base.html' %}

{% block title %}Message Seller - Patch!{% endblock %}

{% block content %}
<section class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- å•†å“ä¿¡æ¯ -->
    <div class="bg-white rounded-2xl shadow-sm p-6 mb-6 border" style="border-color: var(--light-gray);">
        <div class="flex gap-6">
            <div class="w-24 h-24 rounded-lg overflow-hidden flex-shrink-0">
                {% if item.images.first %}
                    <img src="{{ item.images.first.image.url }}" alt="{{ item.name }}" class="w-full h-full object-cover">
                {% else %}
                    <div class="w-full h-full flex items-center justify-center" style="background-color: var(--light-gray);">
                        <span class="text-2xl">ðŸŽ¨</span>
                    </div>
                {% endif %}
            </div>
            <div>
                <h2 class="text-xl font-semibold mb-2" style="color: var(--primary-green);">{{ item.name }}</h2>
                <p class="text-2xl font-semibold" style="color: var(--primary-orange);">${{ item.price }}</p>
            </div>
        </div>
    </div>

    <h1 class="text-2xl font-semibold mb-6" style="color: var(--text-black);">Messages</h1>

    <!-- ç•™è¨€åˆ—è¡¨ -->
    <div class="space-y-4 mb-8">
        {% for msg in item_messages %}
        <div class="bg-white rounded-xl p-4 border {% if msg.sender == request.user %}border-orange-200{% else %}border-gray-200{% endif %}">
            <div class="flex justify-between items-start mb-2">
                <span class="font-semibold" style="color: var(--text-black);">{{ msg.sender.username }}</span>
                <span class="text-sm" style="color: var(--dark-gray);">{{ msg.created_at|date:"M d, Y H:i" }}</span>
            </div>
            <p style="color: var(--text-black);">{{ msg.content }}</p>
        </div>
        {% empty %}
        <p class="text-center py-8" style="color: var(--dark-gray);">No messages yet. Start the conversation!</p>
        {% endfor %}
    </div>

    <!-- å‘é€æ¶ˆæ¯è¡¨å• -->
    <div class="bg-white rounded-2xl shadow-lg p-6 border" style="border-color: var(--light-gray);">
        <h2 class="text-lg font-semibold mb-4" style="color: var(--text-black);">Send a Message</h2>
        <form method="post">
            {% csrf_token %}
            <textarea name="content" rows="4" required placeholder="Type your message here..." class="w-full px-4 py-3 border rounded-lg mb-4" style="border-color: var(--light-gray);"></textarea>
            <div class="flex gap-4">
                <button type="submit" class="flex-1 py-3 rounded-full font-medium btn-primary">
                    Send Message
                </button>
                <a href="{% url 'marketplace:item_detail' item.id %}" class="flex-1 py-3 rounded-full font-medium text-center border hover:bg-gray-50" style="border-color: var(--dark-gray); color: var(--dark-gray);">
                    Back
                </a>
            </div>
        </form>
    </div>
</section>

<style>
    textarea:focus {
        outline: none;
        border-color: var(--primary-orange);
    }
</style>
{% endblock %}